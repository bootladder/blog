<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.4.3">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2018-01-22T18:13:15-08:00</updated><id>/</id><title type="html">Bootladder News</title><subtitle>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
</subtitle><entry><title type="html">CMake: Building an App for Multiple Targets</title><link href="/2018/01/22/cmake-building-an-app-for-multiple-targets.html" rel="alternate" type="text/html" title="CMake: Building an App for Multiple Targets" /><published>2018-01-22T00:00:00-08:00</published><updated>2018-01-22T00:00:00-08:00</updated><id>/2018/01/22/cmake-building-an-app-for-multiple-targets</id><content type="html" xml:base="/2018/01/22/cmake-building-an-app-for-multiple-targets.html">&lt;p&gt;I have an application, it’s a sniffer.&lt;br /&gt;
I want it to run on bare metal, on an OS, and on multiple CPU targets.&lt;br /&gt;
Basically anything with a SPI port and the radio should be able to run this.&lt;br /&gt;
OK, looks like it worked.  Here’s what I learned:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;steve@steve-ThinkPad-T420:~/prog/debos/debos_sniffer$ tree
.
├── build.sh
├── CMakeLists.txt
├── Makefile
├── platform
│   ├── CMakeLists.txt
│   ├── samd20_baremetal
│   └── samd20_debos
│       ├── atsamd20j18.ld
│       ├── CMakeLists.txt
│       └── halStartup.c
├── README.md
├── src
│   ├── app.c
│   ├── my_memcpy.c
│   ├── my_memcpy.h
│   └── System.h
└── tool
    ├── sniffer_parser_lwmesh.py
    └── sniffer_reader.py
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#### The Top Level CMakeLists.txt
cmake_minimum_required(VERSION 3.5)

add_subdirectory(platform)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#### The platform/ CMakeLists.txt
add_subdirectory(samd20_debos)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Now, here’s where all the original stuff went.  platform/samd20_debos CMakeLists.txt.  I made a few modifications to it.&lt;/p&gt;

&lt;p&gt;First notice in the tree, that I have halStartup.c inside of platform/, not src/.  This is because halStartup.c is platform specific; it defines the vector table, startup code, etc.  In the case of the bootloaded (debos) version, the startup code is actually dummy, and it is just there to help the linker create the binary image correctly.  But for the bare metal version, the startup code needs to be correct and actually call the main()  while(1)&lt;/p&gt;

&lt;p&gt;src/ only has app.c , which currently does depend on a SAMD20 specific library.  We’ll take care of that later.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#set(CMAKE_BINARY_DIR ${CMAKE_SOURCE_DIR}/bin)
#set(EXECUTABLE_OUTPUT_PATH ${CMAKE_BINARY_DIR})
#set(LIBRARY_OUTPUT_PATH ${CMAKE_BINARY_DIR})
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;I commented those out, I need to figure out whether I’m supposed to set them myself, or use the preset values.  I did notice that setting CMAKE_BINARY_DIR causes the built binaries to show up there, which is what I want.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; add_custom_command(TARGET debos_sniffer POST_BUILD
-    COMMAND size bin/debos_sniffer
+    COMMAND size debos_sniffer
 )
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Here’s another interesting one.  Before when CMAKE_BINARY_DIR was set to ${CMAKE_SOURCE_DIR}/bin, the custom command worked by specifying bin/debos_sniffer.  This is bin/ at the top level, where .git/ is.  But now, the compiled binary shows up in build/platform/samd20_debos/ , and somehow it is found by just specifying debos_sniffer.&lt;/p&gt;

&lt;p&gt;``` +#file(GLOB SOURCES
+#    “&lt;em&gt;.h”
+#    “&lt;/em&gt;.c”
+#    “hal/&lt;em&gt;.c”
+#    “hal/&lt;/em&gt;.h”
+#)
+
+set(SOURCES   ${CMAKE_SOURCE_DIR}/src/app.c&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;${CMAKE_SOURCE_DIR}/src/my_memcpy.c&lt;/li&gt;
  &lt;li&gt;) 
+
```
Here you see I replaced file(GLOB SOURCES …) with set(SOURCES …),
as recommended by people.  Notice I’m specifying more exactly where the source is; the previous file(GLOB SOURCES …) worked when CMakeLists.txt was inside the directory with the source.&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><summary type="html">I have an application, it’s a sniffer. I want it to run on bare metal, on an OS, and on multiple CPU targets. Basically anything with a SPI port and the radio should be able to run this. OK, looks like it worked. Here’s what I learned: steve@steve-ThinkPad-T420:~/prog/debos/debos_sniffer$ tree . ├── build.sh ├── CMakeLists.txt ├── Makefile ├── platform │   ├── CMakeLists.txt │   ├── samd20_baremetal │   └── samd20_debos │   ├── atsamd20j18.ld │   ├── CMakeLists.txt │   └── halStartup.c ├── README.md ├── src │   ├── app.c │   ├── my_memcpy.c │   ├── my_memcpy.h │   └── System.h └── tool ├── sniffer_parser_lwmesh.py └── sniffer_reader.py ``` The Top Level CMakeLists.txt cmake_minimum_required(VERSION 3.5)</summary></entry><entry><title type="html">Jenkins Job Migration (ie. Jenkins uses too much RAM)</title><link href="/2018/01/21/jenkins-uses-too-much-ram.html" rel="alternate" type="text/html" title="Jenkins Job Migration (ie. Jenkins uses too much RAM)" /><published>2018-01-21T00:00:00-08:00</published><updated>2018-01-21T00:00:00-08:00</updated><id>/2018/01/21/jenkins-uses-too-much-ram</id><content type="html" xml:base="/2018/01/21/jenkins-uses-too-much-ram.html">&lt;p&gt;Dang, I finally figured out why my Docker containers were failing shortly after starting.&lt;br /&gt;
That Error Code 137, Out of Memory.&lt;br /&gt;
Really it’s my stupid Redmine container that’s taking up 30% of my 1GB RAM.  But I can’t do anything about that.&lt;br /&gt;
Jenkins I can consolidate the 3 instances into 1.&lt;br /&gt;
Previously I had 1 Jenkins per toolchain, ie. 1 for arm-linux , 1 for arm-none, 1 for golang, etc.  I liked this because it keeps the toolchain installs independent.&lt;br /&gt;
Now I have to use 1 Jenkins container with all the toolchains inside of it.&lt;/p&gt;

&lt;p&gt;First I’ll have to port all the Jobs into the 1 Jenkins instance.  Then I’ll see them in the Jenkins UI, so I can run builds which will fail due to no toolchain installed.  Then I can install the toolchains.&lt;/p&gt;

&lt;p&gt;Great, copy pasting the jobs/ directories worked, I now see the jobs in the Jenkins homepage.  And of course, running the build fails due to non-existing toolchain.&lt;br /&gt;
So let’s open the Dockerfile and install some toolchains.&lt;/p&gt;

&lt;p&gt;Well it works, pretty obvious.&lt;/p&gt;

&lt;p&gt;Just remember folks, 1GB RAM is easily plenty and easily nothing.  Pay attention to how much your stupid high level frameworks and languages use.&lt;/p&gt;</content><author><name></name></author><summary type="html">Dang, I finally figured out why my Docker containers were failing shortly after starting. That Error Code 137, Out of Memory. Really it’s my stupid Redmine container that’s taking up 30% of my 1GB RAM. But I can’t do anything about that. Jenkins I can consolidate the 3 instances into 1. Previously I had 1 Jenkins per toolchain, ie. 1 for arm-linux , 1 for arm-none, 1 for golang, etc. I liked this because it keeps the toolchain installs independent. Now I have to use 1 Jenkins container with all the toolchains inside of it. First I’ll have to port all the Jobs into the 1 Jenkins instance. Then I’ll see them in the Jenkins UI, so I can run builds which will fail due to no toolchain installed. Then I can install the toolchains. Great, copy pasting the jobs/ directories worked, I now see the jobs in the Jenkins homepage. And of course, running the build fails due to non-existing toolchain. So let’s open the Dockerfile and install some toolchains. Well it works, pretty obvious. Just remember folks, 1GB RAM is easily plenty and easily nothing. Pay attention to how much your stupid high level frameworks and languages use.</summary></entry><entry><title type="html">Debugging a Bootloader with GDB and OpenOCD</title><link href="/2018/01/21/debugging-a-bootloader-with-gdb-and-openocd.html" rel="alternate" type="text/html" title="Debugging a Bootloader with GDB and OpenOCD" /><published>2018-01-21T00:00:00-08:00</published><updated>2018-01-21T00:00:00-08:00</updated><id>/2018/01/21/debugging-a-bootloader-with-gdb-and-openocd</id><content type="html" xml:base="/2018/01/21/debugging-a-bootloader-with-gdb-and-openocd.html">&lt;p&gt;I have a working build of a bootloader.  Let’s flash it.  I have a binary and an ELF.  First let’s flash the binary.&lt;br /&gt;
I’m using a SAMD20 custom board with an Atmel-ICE driven by a Beaglebone running OpenOCD, and I’m driving the Beaglebone with SSH.
Let’s configure the Beaglebone’s OpenOCD conf.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Hmm, arm-none-eabi gcc and gdb are 700mb disk.  No thanks?&lt;/strong&gt;&lt;br /&gt;
Let’s see what we can do with telnet.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;telnet localhost 4444
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Cool, halt and reset work.&lt;br /&gt;
To read some memory use these&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; mdw 0x3ff00
0x0003ff00: 2110002a 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Let’s load an image&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; load_image /tmp/binarg1
8180 bytes written at address 0x00000000
downloaded 8180 bytes in 0.327776s (24.371 KiB/s)
&amp;gt; reset  
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Looks like it worked.  Interestingly there is no LED toggle on the debugger.  I guess edbg puts it in but OpenOCD doesn’t.&lt;/p&gt;

&lt;p&gt;Let’s look at the vector table.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; dump_image /tmp/bindump1 0x0 0x100
dumped 256 bytes in 0.011345s (22.036 KiB/s)
-------
-------
debian@FFNBeagle-A-0:/tmp$ od -tx1 -w4 -Ax bindump1 -v
000000 00 80 00 20
000004 25 07 00 00
000008 65 07 00 00
00000c 0d 07 00 00
000010 00 00 00 00
000014 00 00 00 00
000018 00 00 00 00
00001c 00 00 00 00
000020 00 00 00 00
000024 00 00 00 00
000028 00 00 00 00
00002c 65 07 00 00
000030 00 00 00 00
000034 00 00 00 00
000038 65 07 00 00
00003c 65 07 00 00
000040 65 07 00 00
000044 65 07 00 00
000048 65 07 00 00
00004c f1 06 00 00
000050 fd 05 00 00
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h1 id=&quot;weird-problem-what-is-going-on&quot;&gt;Weird problem, what is going on?&lt;/h1&gt;
&lt;p&gt;As I said, I have a working bootloader and a working application that can be bootloaded and run.  I used edbg, which always worked flawlessly when -p for programming, -e for erasing.  After the firmware is flashed, the application is loaded by serial port, ttyUSB.&lt;br /&gt;
Very weird, I used OpenOCD to flash the bootloader firmware, it was OK, then I used ttyUSB to load the application, that was also OK, but then when I reset the target, it would jump to the application and hit some hard fault or something and reset.  WTF is OpenOCD doing differently?  I’m not even using OpenOCD for erasing anymore, I use edbg because I know for sure it erases, so it must be the programming.  I’m using binary images, not ELF’s so it really should just dump the memory, I don’t see how there could be a difference.&lt;br /&gt;
Well, I know the next thing to try.  Try all the different commands for writing flash memory from a file.  I was using load_image blah.bin , where my blah.bin should start at address 0x0 so no more parameters are supplied to load_image&lt;/p&gt;

&lt;p&gt;OK, before I do that, I should be able to find out what exactly went wrong by analyzing the flash memory contents on target.&lt;br /&gt;
It looks like the bootloader is OK but then fails to jump to the application.  Let’s check the pointers.&lt;/p&gt;

&lt;p&gt;The app loads from 0x2000, and puts a pointer to while(1) at 0x2100.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;gt; mdw 0x2100
0x00002100: 00002229 
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Check the listing for address 2229, that is in app space, check the app listing file.  Well this is weird, jenkins appears to be building a different binary from my laptop.  GCC version is different.  Crap.  We’re going to have to make Jenkins a single point of truth here, and I’ll have to publish the linker map file so I can view it on my laptop.&lt;/p&gt;

&lt;p&gt;Well not sure what’s happening but things seem to be working on OpenOCD again.&lt;/p&gt;</content><author><name></name></author><summary type="html">I have a working build of a bootloader. Let’s flash it. I have a binary and an ELF. First let’s flash the binary. I’m using a SAMD20 custom board with an Atmel-ICE driven by a Beaglebone running OpenOCD, and I’m driving the Beaglebone with SSH. Let’s configure the Beaglebone’s OpenOCD conf.</summary></entry><entry><title type="html">OpenOCD Target Practice</title><link href="/2018/01/20/openocd-target-practice.html" rel="alternate" type="text/html" title="OpenOCD Target Practice" /><published>2018-01-20T00:00:00-08:00</published><updated>2018-01-20T00:00:00-08:00</updated><id>/2018/01/20/openocd-target-practice</id><content type="html" xml:base="/2018/01/20/openocd-target-practice.html">&lt;h1 id=&quot;how-to-actually-write-the-flash--ive-never-used-gdb&quot;&gt;How to actually write the flash?  I’ve never used GDB.&lt;/h1&gt;
&lt;p&gt;First start the OpenOCD server.  This is what I see:  &lt;code class=&quot;highlighter-rouge&quot;&gt;Info : at91samd20j18.cpu: hardware has 4 breakpoints, 2 watchpoints&lt;/code&gt;
Then connect to the server with gdb.  Run the gdb command and then at the prompt type this:  &lt;code class=&quot;highlighter-rouge&quot;&gt;(gdb) target remote localhost:3333&lt;/code&gt;&lt;br /&gt;
I’m using arm-none-eabi-gdb.  If I just run native gdb, I get this output&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Info : accepting 'gdb' connection from 3333
undefined debug reason 7 - target needs reset
Error: CMSIS-DAP: Write Error (0x04)
Error: CMSIS-DAP: Write Error (0x04)
Error: CMSIS-DAP: Write Error (0x04)
Error: CMSIS-DAP: Write Error (0x04)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;But if I run arm-none-eabi-gdb, I get this&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Info : accepting 'gdb' connection from 3333
undefined debug reason 7 - target needs reset
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Now that I’m connected let’s Read some memory addresses.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(gdb) x 0x3FF00
0x3ff00:	0xdeadbeef
(gdb) x 0x3FE00
0x3fe00:	0x11456708
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Great!  Seeing deadbeef is good; it had to come from the target’s flash.&lt;br /&gt;
Interesting, if I supply a bogus address it handles nicely.  This is the output of the OpenOCD server after doing a &lt;code class=&quot;highlighter-rouge&quot;&gt;(gdb) x 90000000&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Error: CMSIS-DAP: Write Error (0x04)
Polling target at91samd20j18.cpu failed, GDB will be halted. Polling again in 100ms
Polling target at91samd20j18.cpu succeeded again
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Let’s try to write something.  Oh dang, doesn’t work.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(gdb) x 0x3f100
0x3f100:	0xffffffff
(gdb) set {int}0x3f100 = 0xdeadbeef
Writing to flash memory forbidden in this context
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Now let’s go to the OpenOCD manual and look at their example.  It says to run gdb with an .elf file.  Let’s do that.  Dang.  Same error.&lt;/p&gt;

&lt;p&gt;But, OpenOCD manual shows using the &lt;code class=&quot;highlighter-rouge&quot;&gt;load&lt;/code&gt; command.  That worked!&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(gdb) set {int}0x3F100=0xdeadbeef
Writing to flash memory forbidden in this context
(gdb) load
Loading section .text, size 0xfea0 lma 0x0
Loading section .debug_breadcrumbs, size 0x4 lma 0xfea0
Loading section .relocate, size 0x110 lma 0xfea4
Start address 0x74b8, load size 65460
Transfer rate: 1 KB/sec, 9351 bytes/write.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Well atleast I can write to RAM.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(gdb) set {int}0x20006000=0xdeadbeef
(gdb) x 0x20006000
0x20006000:	0xdeadbeef
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;OK, here’s another lead.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(gdb) monitor flash probe 0
flash 'at91samd' found at 0x00000000
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;This shows that the flash bank 0 is found at address 0x0.  This is correct.&lt;br /&gt;
Another thing I can do is erase_check&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(gdb) monitor flash erase_check 0
successfully checked erase state
	#  0: 0x00000000 (0x4000 16kB) not erased
	#  1: 0x00004000 (0x4000 16kB) not erased
	#  2: 0x00008000 (0x4000 16kB) not erased
	#  3: 0x0000c000 (0x4000 16kB) not erased
	#  4: 0x00010000 (0x4000 16kB) erased
	#  5: 0x00014000 (0x4000 16kB) erased
	#  6: 0x00018000 (0x4000 16kB) erased
	#  7: 0x0001c000 (0x4000 16kB) erased
	#  8: 0x00020000 (0x4000 16kB) erased
	#  9: 0x00024000 (0x4000 16kB) erased
	# 10: 0x00028000 (0x4000 16kB) erased
	# 11: 0x0002c000 (0x4000 16kB) erased
	# 12: 0x00030000 (0x4000 16kB) erased
	# 13: 0x00034000 (0x4000 16kB) erased
	# 14: 0x00038000 (0x4000 16kB) erased
	# 15: 0x0003c000 (0x4000 16kB) not erased
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;While this is correct, I already know that the page size is 64 bytes and the erase row size is 4 pages, 256 bytes.  Definitely not 16kB.&lt;/p&gt;

&lt;p&gt;I learned here, that when I say &lt;code class=&quot;highlighter-rouge&quot;&gt;(gdb) monitor flash erase_check 0&lt;/code&gt; , what happens is, monitor tells gdb to pass &lt;code class=&quot;highlighter-rouge&quot;&gt;flash erase_check 0&lt;/code&gt; to OpenOCD.  So flash erase_check is an OpenOCD command, documented in the manual.
We can do&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;flash erase_sector num first last&lt;/li&gt;
  &lt;li&gt;flash erase_address [pad] [unlock] address length&lt;/li&gt;
  &lt;li&gt;flash fillw address word length&lt;/li&gt;
  &lt;li&gt;flash fillh address halfword length&lt;/li&gt;
  &lt;li&gt;flash fillb address byte length&lt;/li&gt;
  &lt;li&gt;flash write_bank num filename [offset]&lt;/li&gt;
  &lt;li&gt;program filename [verify] [reset] [exit] [offset]&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;what-happens-with-multiple-debug-interfaces-on-1-host&quot;&gt;What happens with multiple debug interfaces on 1 host?&lt;/h1&gt;

&lt;h1 id=&quot;samd20-custom-board-with-atmel-ice&quot;&gt;SAMD20 Custom Board with Atmel-ICE&lt;/h1&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# Atmel-ICE JTAG/SWD in-circuit debugger.
interface cmsis-dap
cmsis_dap_vid_pid 0x03eb 0x2141

# Chip info
set CHIPNAME at91samd20j18
source [find target/at91samdXX.cfg]
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;This is the output from lsusb -v:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Bus 001 Device 002: ID 03eb:2141 Atmel Corp. 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass          239 Miscellaneous Device
  bDeviceSubClass         2 ?
  bDeviceProtocol         1 Interface Association
  bMaxPacketSize0        64
  idVendor           0x03eb Atmel Corp.
  idProduct          0x2141 
  bcdDevice            1.01
  iManufacturer           1 Atmel Corp.
  iProduct                2 Atmel-ICE CMSIS-DAP
  iSerial                 3 J41800075898
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Let’s just see what happens if I change those IDs.  Interesting, it still works fine, even if I delete the whole line cmsis_dap_vid_pid 0x03eb 0x2141.&lt;br /&gt;
Next with that whole line deleted, I put a spelling mistake,&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;interface cmsis-dapABC&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Open On-Chip Debugger 0.8.0 (2014-10-20-23:18)
Licensed under GNU GPL v2
For bug reports, read
	http://openocd.sourceforge.net/doc/doxygen/bugs.html
Error: The specified debug interface was not found (cmsis-dapz)
The following debug interfaces are available:
1: parport
2: dummy
3: ftdi
4: usb_blaster
5: amt_jtagaccel
6: ep93xx
7: at91rm9200
8: gw16012
9: usbprog
10: jlink
11: vsllink
12: rlink
13: ulink
14: arm-jtag-ew
15: buspirate
16: remote_bitbang
17: hla
18: osbdm
19: opendous
20: aice
21: bcm2835gpio
22: cmsis-dap
Runtime Error: incorrect_openocd.cfg:2: 
in procedure 'script' 
at file &quot;embedded:startup.tcl&quot;, line 58
in procedure 'interface' called at file &quot;incorrect_openocd.cfg&quot;, line 2
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;So here we see the “Interfaces” we can choose.&lt;br /&gt;
Next I examined the Chip Info.&lt;br /&gt;
Deleting the line  &lt;code class=&quot;highlighter-rouge&quot;&gt;set CHIPNAME at91samd20j18&lt;/code&gt; had no change, even setting the name to a bogus value did not affect anything.&lt;br /&gt;
So clearly the important lines are&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;interface cmsis-dap
source [find target/at91samdXX.cfg]
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;So, what is inside target/at91samdXX.cfg ?&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#
# samdXX devices only support SWD transports.
#
source [find target/swj-dp.tcl]
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;OK, what is SWJ-DP ?  What is SWJ?  Let’s see the file.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ARM Debug Interface V5 (ADI_V5) utility
# ... Mostly for SWJ-DP (not SW-DP or JTAG-DP, since
# SW-DP and JTAG-DP targets don't need to switch based
# on which transport is active.
...
...
if [catch {transport select}] {
  echo &quot;Error: unable to select a session transport. Can't continue.&quot;
  shutdown
}

proc swj_newdap {chip tag args} {
 if [using_hla] {
     eval hla newtap $chip $tag $args
 } elseif [using_jtag] {
     eval jtag newtap $chip $tag $args
 } elseif [using_swd] {
     eval swd newdap $chip $tag $args
 }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;The comment at the top explains, SWJ is for debug interfaces that support both JTAG and SWD.  My Atmel-ICE is one of those.&lt;br /&gt;
proc swj_newdap is just a switch to select the command, in my case it would be using_swd so &lt;code class=&quot;highlighter-rouge&quot;&gt;eval swd newdap $chip $tag $args&lt;/code&gt;.&lt;br /&gt;
Hmm where is &lt;code class=&quot;highlighter-rouge&quot;&gt;using_swd&lt;/code&gt; defined, and what is &lt;code class=&quot;highlighter-rouge&quot;&gt;swd newdap&lt;/code&gt; ?&lt;br /&gt;
Back to at91samdXX.cfg , we see this line:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;swj_newdap $_CHIPNAME cpu -irlen 4 -expected-id $_CPUTAPID

set _TARGETNAME $_CHIPNAME.cpu
target create $_TARGETNAME cortex_m -endian $_ENDIAN -chain-position $_TARGETNAME

$_TARGETNAME configure -work-area-phys 0x20000000 -work-area-size $_WORKAREASIZE -work-area-backup 0
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;swj_newdap takes 3 args, chip tag args.  What’s a tag?  Whatever.&lt;br /&gt;
Then there’s &lt;code class=&quot;highlighter-rouge&quot;&gt;target create $_TARGETNAME ...&lt;/code&gt;&lt;br /&gt;
We’re configuring a cortex_m CPU with endianness.&lt;br /&gt;
Then configuring it with a RAM work area?  don’t know what that’s for… does it clobber app ram?&lt;/p&gt;

&lt;p&gt;Then at the end there’s this:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;set _FLASHNAME $_CHIPNAME.flash
flash bank $_FLASHNAME at91samd 0x00000000 0 1 1 $_TARGETNAME
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;I guess we are supplying this information to GDB?&lt;/p&gt;

&lt;h1 id=&quot;samd20-custom-board-with-samd20-xplained-pro&quot;&gt;SAMD20 Custom Board with SAMD20 XPlained Pro&lt;/h1&gt;
&lt;h1 id=&quot;samd20-xplained-pro-self&quot;&gt;SAMD20 XPlained Pro Self&lt;/h1&gt;
&lt;h1 id=&quot;samd10-xplained&quot;&gt;SAMD10 XPLained&lt;/h1&gt;
&lt;h1 id=&quot;samd21-xplained&quot;&gt;SAMD21 XPLained&lt;/h1&gt;
&lt;h1 id=&quot;arduino-leo&quot;&gt;Arduino Leo&lt;/h1&gt;

&lt;h1 id=&quot;how-does-the-raspberry-pi-gpio-driver-interface-work&quot;&gt;How does the Raspberry Pi GPIO Driver Interface work?&lt;/h1&gt;
&lt;p&gt;It’s the bcm2835gpio Debug Interface.
It says See interface/raspberrypi-native.cfg for a sample config and pinout.&lt;br /&gt;
Let’s take a look.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;interface bcm2835gpio

# Transition delay calculation: SPEED_COEFF/khz - SPEED_OFFSET
# These depend on system clock, calibrated for stock 700MHz
# bcm2835gpio_speed SPEED_COEFF SPEED_OFFSET
bcm2835gpio_speed_coeffs 113714 28

# Each of the JTAG lines need a gpio number set: tck tms tdi tdo
# Header pin numbers: 23 22 19 21
bcm2835gpio_jtag_nums 11 25 10 9
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Interesting, there’s another one.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
interface sysfsgpio

# Each of the JTAG lines need a gpio number set: tck tms tdi tdo
# Header pin numbers: 23 22 19 21
sysfsgpio_jtag_nums 11 25 10 9

# At least one of srst or trst needs to be specified
# Header pin numbers: TRST - 26, SRST - 18
sysfsgpio_trst_num 7
# sysfsgpio_srst_num 24
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Notice the pin numbers for JTAG are the same.&lt;br /&gt;
OK, bcm2835 is more directly accessing the hardware.&lt;br /&gt;
But sysfsgpio sounds very interesting, like maybe I can port it to the Beaglebone?&lt;/p&gt;

&lt;h1 id=&quot;references-links&quot;&gt;References, Links&lt;/h1&gt;
&lt;p&gt;http://thehackerworkshop.com/?tag=openocd&lt;/p&gt;</content><author><name></name></author><summary type="html">How to actually write the flash? I’ve never used GDB. First start the OpenOCD server. This is what I see: Info : at91samd20j18.cpu: hardware has 4 breakpoints, 2 watchpoints Then connect to the server with gdb. Run the gdb command and then at the prompt type this: (gdb) target remote localhost:3333 I’m using arm-none-eabi-gdb. If I just run native gdb, I get this output Info : accepting 'gdb' connection from 3333 undefined debug reason 7 - target needs reset Error: CMSIS-DAP: Write Error (0x04) Error: CMSIS-DAP: Write Error (0x04) Error: CMSIS-DAP: Write Error (0x04) Error: CMSIS-DAP: Write Error (0x04) But if I run arm-none-eabi-gdb, I get this Info : accepting 'gdb' connection from 3333 undefined debug reason 7 - target needs reset Now that I’m connected let’s Read some memory addresses. (gdb) x 0x3FF00 0x3ff00: 0xdeadbeef (gdb) x 0x3FE00 0x3fe00: 0x11456708 Great! Seeing deadbeef is good; it had to come from the target’s flash. Interesting, if I supply a bogus address it handles nicely. This is the output of the OpenOCD server after doing a (gdb) x 90000000. Error: CMSIS-DAP: Write Error (0x04) Polling target at91samd20j18.cpu failed, GDB will be halted. Polling again in 100ms Polling target at91samd20j18.cpu succeeded again Let’s try to write something. Oh dang, doesn’t work. (gdb) x 0x3f100 0x3f100: 0xffffffff (gdb) set {int}0x3f100 = 0xdeadbeef Writing to flash memory forbidden in this context Now let’s go to the OpenOCD manual and look at their example. It says to run gdb with an .elf file. Let’s do that. Dang. Same error. But, OpenOCD manual shows using the load command. That worked! (gdb) set {int}0x3F100=0xdeadbeef Writing to flash memory forbidden in this context (gdb) load Loading section .text, size 0xfea0 lma 0x0 Loading section .debug_breadcrumbs, size 0x4 lma 0xfea0 Loading section .relocate, size 0x110 lma 0xfea4 Start address 0x74b8, load size 65460 Transfer rate: 1 KB/sec, 9351 bytes/write. Well atleast I can write to RAM. (gdb) set {int}0x20006000=0xdeadbeef (gdb) x 0x20006000 0x20006000: 0xdeadbeef OK, here’s another lead. (gdb) monitor flash probe 0 flash 'at91samd' found at 0x00000000 This shows that the flash bank 0 is found at address 0x0. This is correct. Another thing I can do is erase_check (gdb) monitor flash erase_check 0 successfully checked erase state # 0: 0x00000000 (0x4000 16kB) not erased # 1: 0x00004000 (0x4000 16kB) not erased # 2: 0x00008000 (0x4000 16kB) not erased # 3: 0x0000c000 (0x4000 16kB) not erased # 4: 0x00010000 (0x4000 16kB) erased # 5: 0x00014000 (0x4000 16kB) erased # 6: 0x00018000 (0x4000 16kB) erased # 7: 0x0001c000 (0x4000 16kB) erased # 8: 0x00020000 (0x4000 16kB) erased # 9: 0x00024000 (0x4000 16kB) erased # 10: 0x00028000 (0x4000 16kB) erased # 11: 0x0002c000 (0x4000 16kB) erased # 12: 0x00030000 (0x4000 16kB) erased # 13: 0x00034000 (0x4000 16kB) erased # 14: 0x00038000 (0x4000 16kB) erased # 15: 0x0003c000 (0x4000 16kB) not erased While this is correct, I already know that the page size is 64 bytes and the erase row size is 4 pages, 256 bytes. Definitely not 16kB. I learned here, that when I say (gdb) monitor flash erase_check 0 , what happens is, monitor tells gdb to pass flash erase_check 0 to OpenOCD. So flash erase_check is an OpenOCD command, documented in the manual. We can do flash erase_sector num first last flash erase_address [pad] [unlock] address length flash fillw address word length flash fillh address halfword length flash fillb address byte length flash write_bank num filename [offset] program filename [verify] [reset] [exit] [offset]</summary></entry><entry><title type="html">arduino-cmake first try</title><link href="/2018/01/16/arduino-cmake-first-try.html" rel="alternate" type="text/html" title="arduino-cmake first try" /><published>2018-01-16T00:00:00-08:00</published><updated>2018-01-16T00:00:00-08:00</updated><id>/2018/01/16/arduino-cmake-first-try</id><content type="html" xml:base="/2018/01/16/arduino-cmake-first-try.html">&lt;p&gt;I cloned the repo.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cd example
mkdir build
cmake ..
CMake Error at CMakeLists.txt:11 (GENERATE_ARDUINO_LIBRARY_EXAMPLE):
  Unknown CMake command &quot;GENERATE_ARDUINO_LIBRARY_EXAMPLE&quot;.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;OK &lt;code class=&quot;highlighter-rouge&quot;&gt;https://github.com/queezythegreat/arduino-cmake/issues/38&lt;/code&gt; solves it.&lt;br /&gt;
mkdir build;cmake .. must happen in the top level CMakeLists.txt directory.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;steve@steve-ThinkPad-T420:~/prog/scratch/arduino-cmake$ mkdir build
steve@steve-ThinkPad-T420:~/prog/scratch/arduino-cmake$ cd build
steve@steve-ThinkPad-T420:~/prog/scratch/arduino-cmake/build$ cmake ..
CMake Error at cmake/ArduinoToolchain.cmake:93 (message):
  Could not find Arduino SDK (set ARDUINO_SDK_PATH)!
Call Stack (most recent call first):
  /usr/share/cmake-3.5/Modules/CMakeDetermineSystem.cmake:98 (include)
  CMakeLists.txt:15 (project)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;OK, it can’t find the toolchain.  It’s not installed.  What happened …&lt;br /&gt;
Line 15 of the top level CMakeLists.txt, was a project() call.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;project(ArduinoExample C CXX ASM)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;And then project() calls CMake core… line 98&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;     include(&quot;${CMAKE_TOOLCHAIN_FILE}&quot; OPTIONAL RESULT_VARIABLE _INCLUDED_TOOLCHAIN_FILE)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;CMAKE_TOOLCHAIN_FILE&lt;/code&gt; is set in the CMakeLists.txt:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#=============================================================================#
# Author: QueezyTheGreat                                                      #
# Date:   26.04.2011                                                          #
#                                                                             #
# Description: Arduino CMake example                                          #
#                                                                             #
#=============================================================================#
set(CMAKE_TOOLCHAIN_FILE cmake/ArduinoToolchain.cmake) # Arduino Toolchain


cmake_minimum_required(VERSION 2.8)
#====================================================================#
#  Setup Project                                                     #
#====================================================================#
project(ArduinoExample C CXX ASM)

print_board_list()
print_programmer_list()

add_subdirectory(example)   #add the example directory into build
~                                                                     
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;So we are reading the ArduinoToolchain.cmake. 
Some interesting things inside here, some I don’t understand.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;set(CMAKE_SYSTEM_NAME Arduino)

set(CMAKE_C_COMPILER avr-gcc)
set(CMAKE_ASM_COMPILER avr-gcc)
set(CMAKE_CXX_COMPILER avr-g++)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Here we are identifying avr-gcc, that’s cool.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#=============================================================================#
#                         System Paths                                        #
#=============================================================================#
if (UNIX)
    include(Platform/UnixPaths)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;include() is like #include in C, so let’s see it.  Huh.. it’s not there.  Let’s see later then…&lt;/p&gt;

&lt;p&gt;Then there’s a part later to detect the &lt;code class=&quot;highlighter-rouge&quot;&gt;ARDUINO_SDK_PATH&lt;/code&gt; using hints, which are directories likely to have the install.&lt;br /&gt;
Let’s just install the SDK now.  To do that just download it and run &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo install.sh&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Now let’s run &lt;code class=&quot;highlighter-rouge&quot;&gt;cmake ..&lt;/code&gt; again.  Still the same error, let’s check the path hints.&lt;br /&gt;
Hmm for some reason the install.sh  doesn’t actually install anything in /usr or /bin or whatever.
Let’s move it manually then into one of the &lt;code class=&quot;highlighter-rouge&quot;&gt;Hints&lt;/code&gt; , /usr/local/share/ .&lt;br /&gt;
&lt;strong&gt;Awesome!&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;steve@steve-ThinkPad-T420:~/prog/scratch/arduino-cmake/build$ cmake ..-- The C compiler identification is GNU 4.9.2
-- The CXX compiler identification is GNU 4.9.2
-- The ASM compiler identification is GNU
-- Found assembler: /usr/local/share/arduino-1.8.5/hardware/tools/avr/bin/avr-gcc
-- Arduino SDK version 1.8.5-2017.01.09: /usr/local/share/arduino-1.8.5
-- Check for working C compiler: /usr/local/share/arduino-1.8.5/hardware/tools/avr/bin/avr-gcc
-- Check for working C compiler: /usr/local/share/arduino-1.8.5/hardware/tools/avr/bin/avr-gcc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Detecting C compile features
-- Detecting C compile features - done
-- Check for working CXX compiler: /usr/local/share/arduino-1.8.5/hardware/tools/avr/bin/avr-g++
-- Check for working CXX compiler: /usr/local/share/arduino-1.8.5/hardware/tools/avr/bin/avr-g++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- ARDUINO Boards:
--                   menu: 
--                    yun: Arduino Y
--                    uno: Arduino/Genuino Uno
--              diecimila: Arduino Duemilanove or Diecimila
--                   nano: Arduino Nano
--                   mega: Arduino/Genuino Mega or Mega 2560
--                megaADK: Arduino Mega ADK
--               leonardo: Arduino Leonardo
--            leonardoeth: Arduino Leonardo ETH
--                  micro: Arduino/Genuino Micro
--                esplora: Arduino Esplora
--                   mini: Arduino Mini
--               ethernet: Arduino Ethernet
--                    fio: Arduino Fio
--                     bt: Arduino BT
--             LilyPadUSB: LilyPad Arduino USB
--                lilypad: LilyPad Arduino
--                    pro: Arduino Pro or Pro Mini
--               atmegang: Arduino NG or older
--           robotControl: Arduino Robot Control
--             robotMotor: Arduino Robot Motor
--                  gemma: Arduino Gemma
--     circuitplay32u4cat: Adafruit Circuit Playground
--                yunmini: Arduino Y
--                chiwawa: Arduino Industrial 101
--                    one: Linino One
--                unowifi: Arduino Uno WiFi
-- 
-- ARDUINO Programmers:
--            avrisp: AVR ISP
--        avrispmkii: AVRISP mkII
--        usbtinyisp: USBtinyISP
--        arduinoisp: ArduinoISP
--     arduinoisporg: ArduinoISP.org
--            usbasp: USBasp
--          parallel: Parallel Programmer
--      arduinoasisp: Arduino as ISP
--          usbGemma: Arduino Gemma
--         buspirate: BusPirate as ISP
--            stk500: Atmel STK500 development board
--          jtag3isp: Atmel JTAGICE3 (ISP mode)
--             jtag3: Atmel JTAGICE3 (JTAG mode)
--         atmel_ice: Atmel-ICE (AVR)
-- 
-- Generating wire_example
-- avr library found: Wire
-- Generating blink_example
-- Generating blink_original
-- Generating blink_file_original
-- Generating blink_bundled
-- Generating blink_lib
-- Generating blink
-- Generating serial_lib
-- avr library found: SoftwareSerial
-- Configuring done
-- Generating done
-- Build files have been written to: /home/steve/prog/scratch/arduino-cmake/build
steve@steve-ThinkPad-T420:~/prog/scratch/arduino-cmake/build$ 

&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;What’s that stuff about boards and programmers?
How does that last part work, &lt;code class=&quot;highlighter-rouge&quot;&gt;Generating blink_example&lt;/code&gt; ?&lt;br /&gt;
Somehow, CMakeLists.txt at the top level was able to find all of those things.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Easy&lt;/strong&gt; , that’s in the top CMakeLists.txt:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#====================================================================#
#  Setup Project                                                     #
#====================================================================#
project(ArduinoExample C CXX ASM)

print_board_list()
print_programmer_list()

add_subdirectory(example)   #add the example directory into build
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;So literally it prints the board lists and programmer list, and recurses into the example directory.&lt;/p&gt;

&lt;p&gt;So, the examples/CMakeLists.txt.&lt;br /&gt;
All that happens is this:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;set(ARDUINO_DEFAULT_BOARD uno) # Default Board ID, when not specified
set(ARDUINO_DEFAULT_PORT /dev/ttyUSB0) # Default Port, when not specified
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#====================================================================#
# Advanced firwmare example
#====================================================================#
generate_arduino_firmware(blink
        SRCS blink.cpp
        LIBS blink_lib
        BOARD nano
        BOARD_CPU atmega328
        PORT com4
        )
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Wow that’s not too bad , I’d like to give it a try!&lt;/p&gt;

&lt;p&gt;It looks like it should be easy to support the ARM chips, and use this to create new Arduino Libraries.&lt;/p&gt;</content><author><name></name></author><summary type="html">I cloned the repo. cd example mkdir build cmake .. CMake Error at CMakeLists.txt:11 (GENERATE_ARDUINO_LIBRARY_EXAMPLE): Unknown CMake command &quot;GENERATE_ARDUINO_LIBRARY_EXAMPLE&quot;. OK https://github.com/queezythegreat/arduino-cmake/issues/38 solves it. mkdir build;cmake .. must happen in the top level CMakeLists.txt directory. steve@steve-ThinkPad-T420:~/prog/scratch/arduino-cmake$ mkdir build steve@steve-ThinkPad-T420:~/prog/scratch/arduino-cmake$ cd build steve@steve-ThinkPad-T420:~/prog/scratch/arduino-cmake/build$ cmake .. CMake Error at cmake/ArduinoToolchain.cmake:93 (message): Could not find Arduino SDK (set ARDUINO_SDK_PATH)! Call Stack (most recent call first): /usr/share/cmake-3.5/Modules/CMakeDetermineSystem.cmake:98 (include) CMakeLists.txt:15 (project) OK, it can’t find the toolchain. It’s not installed. What happened … Line 15 of the top level CMakeLists.txt, was a project() call. project(ArduinoExample C CXX ASM) And then project() calls CMake core… line 98 include(&quot;${CMAKE_TOOLCHAIN_FILE}&quot; OPTIONAL RESULT_VARIABLE _INCLUDED_TOOLCHAIN_FILE) CMAKE_TOOLCHAIN_FILE is set in the CMakeLists.txt: ``` #=============================================================================# Author: QueezyTheGreat Date: 26.04.2011 # # Description: Arduino CMake example # # #=============================================================================# set(CMAKE_TOOLCHAIN_FILE cmake/ArduinoToolchain.cmake) # Arduino Toolchain</summary></entry><entry><title type="html">Bring up New Ubuntu System</title><link href="/2018/01/14/bring-up-new-ubuntu-system.html" rel="alternate" type="text/html" title="Bring up New Ubuntu System" /><published>2018-01-14T00:00:00-08:00</published><updated>2018-01-14T00:00:00-08:00</updated><id>/2018/01/14/bring-up-new-ubuntu-system</id><content type="html" xml:base="/2018/01/14/bring-up-new-ubuntu-system.html">&lt;p&gt;Ubuntu on my laptop was crashing regularly and taking way too long to boot from the SSD.&lt;/p&gt;

&lt;h1 id=&quot;editing-this-blog&quot;&gt;Editing this Blog&lt;/h1&gt;
&lt;p&gt;Need: Clone git repo, apt-get install ruby ruby-dev, gem install bundler, bundle install&lt;br /&gt;
Need: Production repo URL, so it can be pushed to.&lt;br /&gt;
The prod remote is a bare git repo on the production server.&lt;br /&gt;
Put in the url to it?  Behind web root?  &lt;em&gt;A:  use the whole SSH URL&lt;/em&gt;&lt;br /&gt;
Use ~/.ssh/config to specify the key to be used.&lt;br /&gt;
&lt;em&gt;New&lt;/em&gt;:  The built _site had been stored in the git repo, so it
could be directly copied into the bare remote, and then copied to the deploy.
I thought of course, to &lt;code class=&quot;highlighter-rouge&quot;&gt;git rm&lt;/code&gt; the _site and then run &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll build&lt;/code&gt;
inside /deploy, but of course jekyll was not installed.&lt;br /&gt;
So for now I put the built _site back in the repo.&lt;/p&gt;

&lt;h1 id=&quot;atom-ide&quot;&gt;Atom IDE&lt;/h1&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sudo add-apt-repository ppa:webupd8team/atom&lt;/code&gt;&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;sudo apt update; sudo apt install atom&lt;/code&gt;&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;Source: http://tipsonubuntu.com/2016/08/05/install-atom-text-editor-ubuntu-16-04/&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;aliases&quot;&gt;Aliases&lt;/h1&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#Steve Aliases
alias l='ls -ltrh --color=auto'
alias gs='git status'
alias gl='git log'
alias gd='git diff'
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h1 id=&quot;random-color-command-prompt&quot;&gt;Random Color Command Prompt&lt;/h1&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;---
...inside .bashrc
---
function nextcolor
{
    mycolor=$(($RANDOM % 7 + 31))
    echo $mycolor
}
if [ &quot;$color_prompt&quot; = yes ]; then
    PS1='${debian_chroot:+($debian_chroot)}\[\033[01;$(nextcolor)m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ '
else
    PS1='${debian_chroot:+($debian_chroot)}\u@\h:\w\$ '
fi
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h1 id=&quot;vim&quot;&gt;VIM&lt;/h1&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sudo apt-get install vim&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;~/.vimrc
set noexpandtab
set tabstop=2
set shiftwidth=2
set clipboard=unnamedplus
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h1 id=&quot;golang&quot;&gt;Golang&lt;/h1&gt;

&lt;p&gt;Copy pasted from instructions: https://golang.org/doc/install?download=go1.9.2.linux-amd64.tar.gz&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Linux, Mac OS X, and FreeBSD tarballs

Download the archive and extract it into /usr/local, creating a Go tree in /usr/local/go. For example:

tar -C /usr/local -xzf go1.9.2.linux-amd64.tar.gz

(Typically these commands must be run as root or through sudo.)

Add /usr/local/go/bin to the PATH environment variable. You can do this by adding this line to your /etc/profile (for a system-wide installation) or $HOME/.profile:

export PATH=$PATH:/usr/local/go/bin
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;go get -t -u ./...&lt;/code&gt; -u installs from the net, -t installs for tests.&lt;br /&gt;
&lt;strong&gt;-t is not in man go get ???&lt;/strong&gt;&lt;/p&gt;

&lt;h1 id=&quot;misc&quot;&gt;Misc&lt;/h1&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git clone https://github.com/sstephenson/bats.git
cd bats
./install.sh /usr/local
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h1 id=&quot;thunderbird&quot;&gt;Thunderbird&lt;/h1&gt;
&lt;p&gt;Don’t download all emails from IMAP server, only last 30 days
&lt;code class=&quot;highlighter-rouge&quot;&gt;Source: https://support.mozilla.org/en-US/questions/1066286&lt;/code&gt;&lt;br /&gt;
Why doesn’t this work, it downloaded all my emails.  Maybe because there weren’t that many of them?&lt;/p&gt;

&lt;h1 id=&quot;servers&quot;&gt;Servers&lt;/h1&gt;
&lt;p&gt;Need SSH Keys, Hostnames, Root Passwords, IP Addresses&lt;br /&gt;
&lt;em&gt;Gnome Keyring&lt;/em&gt; turns out it reads the keys stored in ~/.ssh.  Confirmed, easy, just copy the keys into there.  Continue using ~/.ssh/config to specify which key per host&lt;/p&gt;

&lt;h1 id=&quot;ubuntu-crap&quot;&gt;Ubuntu Crap&lt;/h1&gt;
&lt;p&gt;Disable Caps-Lock:  &lt;code class=&quot;highlighter-rouge&quot;&gt;sudo apt-get install gnome-tweak-tool&lt;/code&gt;  , go to “Typing”&lt;br /&gt;
Eable Workspaces:  &lt;code class=&quot;highlighter-rouge&quot;&gt;Settings--&amp;gt;Appearance--&amp;gt;Behavior--&amp;gt;Enable Workspaces&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;arm-none-eabi-gcc&quot;&gt;arm-none-eabi-gcc&lt;/h1&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;apt-get install gcc-arm-none-eabi&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;irc&quot;&gt;IRC&lt;/h1&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;apt-get install xchat-gnome&lt;/code&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;/msg nickserv register&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;synergy&quot;&gt;Synergy&lt;/h1&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;https://github.com/symless/synergy-core/wiki/Compiling&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; git clone https://github.com/symless/synergy-core.git
 cd synergy-core
 mkdir build
 cd build
 cmake ..
 make
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;An Ubuntu 16 laptop didn’t have libcurl so,&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;apt-get install libcurl4-openssl-dev&lt;/code&gt;&lt;br /&gt;
Also it didn’t have XKBlib.h
&lt;code class=&quot;highlighter-rouge&quot;&gt;apt-get install libx11-dev&lt;/code&gt;&lt;br /&gt;
As other people have noticed you have to edit CMakeLists.txt to change path to find XKBLib.h&lt;br /&gt;
Change it to /usr/include.&lt;br /&gt;
Weird, CMake still can’t find it, but if i do a rm -rf build and repeat the build again it works.&lt;br /&gt;
Then it can’t find libxtst. &lt;code class=&quot;highlighter-rouge&quot;&gt;apt-get install libxtst-dev&lt;/code&gt;&lt;br /&gt;
That worked well, now make a config file like this:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;section: screens
        steve-T420:
        steve-T420-ZoZ:
        bob-pc:
end
section: links
        steve-T420:
                down = steve-T420-ZoZ
                left = bob-pc
        steve-T420-ZoZ:
                up = steve-T420
        bob-pc:
                right = steve-T420
end
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Then run it with this&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;./synergys -f -c /etc/synergy.conf&lt;/code&gt;&lt;br /&gt;
Run the client like this&lt;br /&gt;
` synergyc -f 10.0.1.23`&lt;/p&gt;

&lt;h1 id=&quot;hopper&quot;&gt;Hopper&lt;/h1&gt;
&lt;p&gt;Just download the .deb, Ubuntu software manager fails miserably as usual, but doing this apparently makes it work&lt;br /&gt;
` sudo dpkg -i Hopper-v4-4.3.12-Linux.deb `&lt;/p&gt;</content><author><name></name></author><summary type="html">Ubuntu on my laptop was crashing regularly and taking way too long to boot from the SSD. Editing this Blog Need: Clone git repo, apt-get install ruby ruby-dev, gem install bundler, bundle install Need: Production repo URL, so it can be pushed to. The prod remote is a bare git repo on the production server. Put in the url to it? Behind web root? A: use the whole SSH URL Use ~/.ssh/config to specify the key to be used. New: The built _site had been stored in the git repo, so it could be directly copied into the bare remote, and then copied to the deploy. I thought of course, to git rm the _site and then run jekyll build inside /deploy, but of course jekyll was not installed. So for now I put the built _site back in the repo.</summary></entry><entry><title type="html">Name Versioning and Publishing Latest Release</title><link href="/2017/11/09/semantic-versioning-and-publishing-latest-release.html" rel="alternate" type="text/html" title="Name Versioning and Publishing Latest Release" /><published>2017-11-09T00:00:00-08:00</published><updated>2017-11-09T00:00:00-08:00</updated><id>/2017/11/09/semantic-versioning-and-publishing-latest-release</id><content type="html" xml:base="/2017/11/09/semantic-versioning-and-publishing-latest-release.html">&lt;p&gt;After I got Jenkins building my code, there was no semantic versioning so this is what happened:&lt;br /&gt;
The built executable would have the same name every build so got overwritten.&lt;br /&gt;
I had a version number but more at a higher level, like a release number.&lt;br /&gt;
Now I need something to identify each build, ie. each commit.&lt;/p&gt;

&lt;p&gt;So I did this in CMake:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;...
set(THIS_BUILD_VERSION 0x2B30)
...
add_executable(myexename ${SOURCES} ${SOURCES_RECURSE} )

EXEC_PROGRAM(
&quot;echo $(git rev-parse --abbrev-ref HEAD)_$(git rev-parse --short HEAD)&quot; 
OUTPUT_VARIABLE gitrepoinfo
)

set(output_exe_filename MY_EXE_PREFIX_${THIS_BUILD_VERSION}_${gitrepoinfo})
set_target_properties(myexename PROPERTIES OUTPUT_NAME ${output_exe_filename})
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;EXEC_PROGRAM is what worked for me , not the other execute_process or whatever.&lt;br /&gt;
I echo 2 git commands to get the branch name and short commit ID.&lt;/p&gt;

&lt;p&gt;Then I set the variable for the executable’s filename, and tell the target to be named by it.&lt;/p&gt;

&lt;p&gt;This worked, so now every time I git push I get a new build identifying that commit.&lt;br /&gt;
Now the problem is, the filenames are too long to type by hand so I need something 
like “latest-version.out” as an easy reference.&lt;br /&gt;
I tried to use symlinks, that didn’t work.&lt;/p&gt;

&lt;p&gt;Simple solution for now is to have Jenkins zip up the build, name it latest.zip ,
and publish that along with the non-zipped originals.&lt;br /&gt;
That way the zip is always overwritten with the latest.zip, and the originals are still
piling up for backup.&lt;/p&gt;</content><author><name></name></author><summary type="html">After I got Jenkins building my code, there was no semantic versioning so this is what happened: The built executable would have the same name every build so got overwritten. I had a version number but more at a higher level, like a release number. Now I need something to identify each build, ie. each commit. So I did this in CMake: ``` … set(THIS_BUILD_VERSION 0x2B30) … add_executable(myexename ${SOURCES} ${SOURCES_RECURSE} )</summary></entry><entry><title type="html">CMake redo</title><link href="/2017/11/08/cmake-redo.html" rel="alternate" type="text/html" title="CMake redo" /><published>2017-11-08T00:00:00-08:00</published><updated>2017-11-08T00:00:00-08:00</updated><id>/2017/11/08/cmake-redo</id><content type="html" xml:base="/2017/11/08/cmake-redo.html">&lt;p&gt;Running into so many little issues.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;External Libraries, git repos&lt;br /&gt;
I have 2 libraries that are shared by multiple projects.
I’ve experimented with linking to a prebuilt binary that is shared by multiple projects,
or having each individual project compile the library source.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Linking to prebuilt worked before when I wasn’t automating my build.&lt;br /&gt;
I just installed the libraries and used hard coded paths to connect everything up in my handwritten Makefile.&lt;br /&gt;
Now I can’t do that, I want this on Jenkins and quick deploy.&lt;/p&gt;

&lt;p&gt;So I am trying to build the source.&lt;br /&gt;
I took the libraries out of the /src tree&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ExternalProject_Add(XYZ_COMMON_SOURCE
    GIT_REPOSITORY &quot;https://steve@bitbucket.org/xyz/xyz_common_source.git&quot;
    BUILD_COMMAND &quot;&quot;
    UPDATE_COMMAND &quot;&quot;
    CONFIGURE_COMMAND &quot;&quot;
    INSTALL_COMMAND &quot;&quot;
    PREFIX &quot;/tmp/lib/&quot;
)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;`/tmp/lib is under the filesystem root, not a cmake root’&lt;/p&gt;

&lt;p&gt;This allowed me to do this&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;file(GLOB_RECURSE SOURCES_RECURSE
    &quot;/tmp/lib/src/XYZ_COMMON_SOURCE/*.c&quot;
    &quot;/tmp/lib/src/XYZ_COMMON_SOURCE/*.h&quot;
)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h1 id=&quot;but-my-next-problem-is-some-of-these-source-files-have-header-dependencies--interface-header&quot;&gt;But my next problem is, some of these source files have header dependencies.  Interface header.&lt;/h1&gt;

&lt;p&gt;One of the files in COMMON_SOURCE has a header, “IHAL_MYSERIAL.h”
A hardware interface.&lt;br /&gt;
The project I’m trying to build now doesn’t have that interface or use that source file.&lt;br /&gt;
But CMake wants to build all the source files, and IHAL_MYSERIAL.h isn’t there.
Eh, thinking again, the header should be in there.  I put it in.&lt;/p&gt;

&lt;p&gt;OK got somewhere, just had to take out some files from the Primary project that
were multiply defined with the common source.&lt;br /&gt;
Previously I had avoided this by individually selecting each source file to be built.&lt;br /&gt;
But now I’m building everything so there are conflicts due to that.&lt;/p&gt;

&lt;h1 id=&quot;small-note&quot;&gt;Small Note,&lt;/h1&gt;
&lt;p&gt;If the build fails I guess the artifacts are deleted?&lt;br /&gt;
I had a GNU size command running after the linker step, but it failed due to the wrong path.&lt;br /&gt;
When that happened there was no binary in the bin directory.&lt;br /&gt;
But removing the size command entirely, the binary was there.  Also when fixing the wrong path,
the binary was there.&lt;/p&gt;</content><author><name></name></author><summary type="html">Running into so many little issues.</summary></entry><entry><title type="html">Bitbucket Access Keys inside a Jenkins Container</title><link href="/2017/11/08/bitbucket-access-keys-inside-a-jenkins-container.html" rel="alternate" type="text/html" title="Bitbucket Access Keys inside a Jenkins Container" /><published>2017-11-08T00:00:00-08:00</published><updated>2017-11-08T00:00:00-08:00</updated><id>/2017/11/08/bitbucket-access-keys-inside-a-jenkins-container</id><content type="html" xml:base="/2017/11/08/bitbucket-access-keys-inside-a-jenkins-container.html">&lt;p&gt;Bit of extra work to get a container to talk to Bitbucket.&lt;br /&gt;
This is necessary because Jenkins needs to pull private repos autmatically,
so must use keys.&lt;br /&gt;
The key could be baked in the image but then I can’t share it.&lt;br /&gt;
So what I did was put in a global /etc/ssh/ssh_config that points to a key
inside the shared data volume.  I simply stick the key in there.&lt;/p&gt;

&lt;p&gt;First generate the key, then copy/paste it into bitbucket repo settings access key.
Then copy the key to an accessible server.
Then copy the key into the Docker host and then docker container.&lt;/p&gt;

&lt;p&gt;ssh -i bitbucket_access_key git@bitbucket.org&lt;/p&gt;

&lt;p&gt;to make sure the key works.&lt;/p&gt;

&lt;p&gt;Then configure SSH to use the keys there.&lt;/p&gt;

&lt;p&gt;Problem, the only shared volume is /var/jenkins_home in the container.  /etc is not persistent.
We’ll have to bake it into the image?&lt;/p&gt;

&lt;p&gt;Add this to the Dockerfile and add this file&lt;/p&gt;

&lt;p&gt;Host bitbucket.org
    HostName bitbucket.org
    User steveODI
    IdentityFile /var/jenkins_home/bitbucket_access_key&lt;/p&gt;

&lt;p&gt;Dockerfile:
COPY ssh_config /home/jenkins/.ssh/ssh_config&lt;/p&gt;

&lt;p&gt;no,
COPY ssh_config /etc/ssh/ssh_config&lt;/p&gt;</content><author><name></name></author><summary type="html">Bit of extra work to get a container to talk to Bitbucket. This is necessary because Jenkins needs to pull private repos autmatically, so must use keys. The key could be baked in the image but then I can’t share it. So what I did was put in a global /etc/ssh/ssh_config that points to a key inside the shared data volume. I simply stick the key in there.</summary></entry><entry><title type="html">jenkins and build inside a docker container</title><link href="/2017/10/27/jenkins-and-build-inside-a-docker-container.html" rel="alternate" type="text/html" title="jenkins and build inside a docker container" /><published>2017-10-27T00:00:00-07:00</published><updated>2017-10-27T00:00:00-07:00</updated><id>/2017/10/27/jenkins-and-build-inside-a-docker-container</id><content type="html" xml:base="/2017/10/27/jenkins-and-build-inside-a-docker-container.html">&lt;p&gt;Jenkins will be available through some URL.
The build toolchain will be installed in the Dockerfile,
on top of the jenkins image.&lt;/p&gt;

&lt;p&gt;Toolchain is static but the code isn’t so the code building
is done inside the container.  pulling the code, dependencies,
building it, etc is a script run inside the container.&lt;/p&gt;

&lt;p&gt;Installed docker on the fresh VM with the get docker script.&lt;br /&gt;
Installed docker-compose also from docker.io hosted script.&lt;/p&gt;</content><author><name></name></author><summary type="html">Jenkins will be available through some URL. The build toolchain will be installed in the Dockerfile, on top of the jenkins image. Toolchain is static but the code isn’t so the code building is done inside the container. pulling the code, dependencies, building it, etc is a script run inside the container. Installed docker on the fresh VM with the get docker script. Installed docker-compose also from docker.io hosted script.</summary></entry></feed>